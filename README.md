# TIRF Image Analysis for Glut10-Rab5 Vesicle Colocalization

This repository contains Python code for analyzing time series TIRF (Total Internal Reflection Fluorescence) microscopy images to identify and track colocalized Glut10 and Rab5 vesicles.

## Overview

The code processes TIRF images of Glut10-GFP and Rab5-RFP to:

1. Identify Glut10 and Rab5 vesicles
2. Analyze colocalization between Glut10 and Rab5 signals
3. Generate labeled images for further tracking analysis
4. Produce colocalization statistics and visualizations

## Requirements

- Python 3.9+
- GPU with OpenCL support
- Libraries: numpy, pyclesperanto_prototype, napari, matplotlib, scikit-image, pandas, napari_simpleitk_image_processing

The code was tested in the `devbio-napari` environment. See [devbio-napari](https://github.com/haesleinhuepf/devbio-napari) for setup instructions.
Alternatively, a "tested_devbio-napari-env.yml" is also provided.

## Usage

1. Update file paths in the script to point to your TIRF image files.
2. Run the Jupyter notebook cells sequentially.
3. Adjust parameters as needed (e.g. DoG filter sizes, overlap score thresholds).

## Key Steps

1. Load Glut10, Rab5, and cell label images
2. Apply Difference of Gaussian (DoG) filtering to both channels
3. Generate Glut10 labels using Voronoi-Otsu labeling
4. Create Rab5 masks using triangle thresholding
5. Calculate overlap scores between Glut10 labels and Rab5 masks
6. Categorize vesicles as colocalized, mid-colocalized, or non-colocalized
7. Export colocalization data to Excel
8. Generate plots of colocalization over time

## Output

- Processed image stacks (DoG filtered, labeled, masked)
- Excel file with colocalization statistics
- Plots showing colocalization trends over time

## Post-processing

The code includes an optional step to clean tracking label images by removing unwanted labels (e.g. -1 values) generated by TrackMate.


## Reference for Libraries and Frameworks

### NumPy
- **Description**: Used for numerical operations and array manipulations.
- **Reference**: Harris, C. R., Millman, K. J., van der Walt, S. J., et al. (2020). Array programming with NumPy. *Nature*, 585(7825), 357-362. DOI:10.1038/s41586-020-2649-2
- **GitHub**: [numpy/numpy](https://github.com/numpy/numpy)

### pyclesperanto_prototype
- **Description**: A GPU-accelerated image processing library.
- **Reference**: Haase, R., Royer, L. A., Steinbach, P., et al. (2020). CLIJ: GPU-accelerated image processing for everyone. *Nature Methods*, 17(1), 5-6. DOI:10.1038/s41592-019-0650-1
- **GitHub**: [clEsperanto/pyclesperanto_prototype](https://github.com/clEsperanto/pyclesperanto_prototype)

### napari
- **Description**: A fast, interactive, multi-dimensional image viewer for Python.
- **Reference**: Sofroniew, N., Lambert, T., Evans, K., et al. (2022). napari: a multi-dimensional image viewer for Python. *Zenodo*. DOI:10.5281/zenodo.3555620
- **GitHub**: [napari/napari](https://github.com/napari/napari)

### Matplotlib
- **Description**: A plotting library for creating static, interactive, and animated visualizations in Python.
- **Reference**: Hunter, J. D. (2007). Matplotlib: A 2D graphics environment. *Computing in Science & Engineering*, 9(3), 90-95. DOI:10.1109/MCSE.2007.55
- **GitHub**: [matplotlib/matplotlib](https://github.com/matplotlib/matplotlib)

### scikit-image
- **Description**: A collection of algorithms for image processing in Python.
- **Reference**: van der Walt, S., Sch√∂nberger, J. L., Nunez-Iglesias, J., et al. (2014). scikit-image: Image processing in Python. *PeerJ*, 2, e453. DOI:10.7717/peerj.453
- **GitHub**: [scikit-image/scikit-image](https://github.com/scikit-image/scikit-image)

### pandas
- **Description**: A data analysis and manipulation library for Python.
- **Reference**: McKinney, W. (2010). Data Structures for Statistical Computing in Python. *Proceedings of the 9th Python in Science Conference*, 51-56. DOI:10.25080/Majora-92bf1922-00a
- **GitHub**: [pandas-dev/pandas](https://github.com/pandas-dev/pandas)

### napari_simpleitk_image_processing
- **Description**: A plugin for napari that provides image processing capabilities using SimpleITK.
- **GitHub**: [haesleinhuepf/napari-simpleitk-image-processing](https://github.com/haesleinhuepf/napari-simpleitk-image-processing)

## Reference for Algorithms and Techniques

### Difference of Gaussian (DoG) filtering
- **Description**: Feature enhancement technique
- **Reference**: Marr, D., & Hildreth, E. (1980). Theory of edge detection. *Proceedings of the Royal Society of London. Series B. Biological Sciences*, 207(1167), 187-217.

### Voronoi-Otsu Labeling
- **Description**: Segmentation method combining Voronoi tessellation and Otsu thresholding
- **Reference**: Otsu, N. (1979). A threshold selection method from gray-level histograms. *IEEE transactions on systems, man, and cybernetics*, 9(1), 62-66.

### Triangle thresholding
- **Description**: Automatic thresholding method
- **Reference**: Zack, G. W., Rogers, W. E., & Latt, S. A. (1977). Automatic measurement of sister chromatid exchange frequency. *Journal of Histochemistry & Cytochemistry*, 25(7), 741-753.
